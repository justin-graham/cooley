<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tieout: Corporate Governance Auditing</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/landing.css">
</head>
<body class="landing-page">
    <!-- Header Text -->
    <header class="landing-header">
        <h1 class="landing-title">AI-powered corporate governance analysis.</h1>
    </header>

    <!-- Main content: Animation + Auth in two columns -->
    <div class="landing-main">
        <section class="landing-animation">
            <div class="fig-window">
                <div class="fig-header">
                    <div class="fig-header-left">
                        <span>&gt;_</span>
                    </div>
                    <div class="fig-header-center">[ Tieout ]</div>
                    <div class="fig-header-right">
                        <svg viewBox="0 0 24 24" fill="none">
                            <line x1="4" y1="7" x2="20" y2="7" stroke-width="1.4" />
                            <circle cx="10" cy="7" r="1.8" stroke-width="1.2" fill="none" />
                            <line x1="4" y1="17" x2="20" y2="17" stroke-width="1.4" />
                            <circle cx="14" cy="17" r="1.8" stroke-width="1.2" fill="none" />
                        </svg>
                    </div>
                </div>
                <div class="fig-inner">
                    <div class="fig-canvas-wrap" id="fig18Wrap">
                        <canvas id="fig18Canvas"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Auth Form -->
        <section class="landing-auth">
            <form id="auth-form" class="auth-form">
                <div class="form-group">
                    <label for="username" class="sr-only">Email</label>
                    <input
                        type="text"
                        id="username"
                        name="username"
                        placeholder="email"
                        required
                        autocomplete="username"
                        aria-label="Email address"
                    />
                </div>
                <div class="form-group">
                    <label for="password" class="sr-only">Password</label>
                    <input
                        type="password"
                        id="password"
                        name="password"
                        placeholder="password"
                        required
                        autocomplete="current-password"
                        aria-label="Password"
                    />
                </div>
                <button type="submit" class="auth-submit">Sign In</button>
                <div id="auth-error" class="auth-error" role="alert" style="display: none;"></div>
            </form>
        </section>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-brand">
                <img src="/static/tieout-logo.png" alt="Tieout" class="footer-logo">
            </div>
            <div class="footer-action">
                <form id="access-form" class="access-form">
                    <input type="email" id="access-email" name="email" placeholder="email@example.com" required />
                    <button type="submit" class="access-submit">Get invitation</button>
                </form>
            </div>
            <div class="footer-copyright">
                Tieout v1.0 | Justin Graham
            </div>
        </div>
    </footer>

    <script>
        // 10 PRINT Grid Animation
        const canvas = document.getElementById("fig18Canvas");
        const wrap = document.getElementById("fig18Wrap");
        const ctx = canvas.getContext("2d");

        let dpr = window.devicePixelRatio || 1;

        // Line segments and draw order
        let segments = [];   // {x1,y1,x2,y2}
        let drawOrder = [];  // indices into segments[]
        let progress = 0;
        let direction = 1;   // 1 = drawing in, -1 = erasing

        function resizeCanvas() {
            const rect = wrap.getBoundingClientRect();
            dpr = window.devicePixelRatio || 1;
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
            buildPattern();
        }

        function addSegment(x1, y1, x2, y2) {
            segments.push({ x1, y1, x2, y2 });
        }

        // Build a 10-PRINT grid that fills the whole canvas area
        function buildPattern() {
            segments = [];

            const width = canvas.width / dpr;
            const height = canvas.height / dpr;

            // Choose roughly how many cells along the larger axis
            const targetCells = 40;
            const gridSize = Math.max(width, height) / targetCells;

            const gridWidth = Math.ceil(width / gridSize) + 2;
            const gridHeight = Math.ceil(height / gridSize) + 2;

            const totalW = gridWidth * gridSize;
            const totalH = gridHeight * gridSize;
            const startX = -totalW / 2;
            const startY = -totalH / 2;

            for (let gy = 0; gy < gridHeight; gy++) {
                for (let gx = 0; gx < gridWidth; gx++) {
                    const x = startX + gx * gridSize;
                    const y = startY + gy * gridSize;

                    // Randomly choose / or \
                    if (Math.random() > 0.5) {
                        // /
                        addSegment(x, y, x + gridSize, y + gridSize);
                    } else {
                        // \
                        addSegment(x + gridSize, y, x, y + gridSize);
                    }
                }
            }

            // --- RANDOM build order (Fisher–Yates) ---
            drawOrder = segments.map((_, i) => i);
            for (let i = drawOrder.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [drawOrder[i], drawOrder[j]] = [drawOrder[j], drawOrder[i]];
            }

            progress = 0;
            direction = 1;
        }

        function drawFrame() {
            const width = canvas.width / dpr;
            const height = canvas.height / dpr;

            // Keep CSS dotted background visible
            ctx.clearRect(0, 0, width, height);

            ctx.save();
            ctx.translate(width / 2, height / 2);
            ctx.strokeStyle = "#111827";
            ctx.lineWidth = 0.7;
            ctx.globalAlpha = 0.85;

            const maxSegments = segments.length;
            const count = Math.max(
                0,
                Math.min(maxSegments, Math.floor(progress))
            );

            ctx.beginPath();
            for (let n = 0; n < count; n++) {
                const s = segments[drawOrder[n]];
                ctx.moveTo(s.x1, s.y1);
                ctx.lineTo(s.x2, s.y2);
            }
            ctx.stroke();
            ctx.restore();

            // animate construct -> deconstruct
            const speed = 3; // segments per frame
            progress += direction * speed;

            if (progress >= maxSegments + 20) {
                direction = -1;
            } else if (progress <= 0) {
                // fully erased – regenerate a new random pattern
                buildPattern();
            }

            requestAnimationFrame(drawFrame);
        }

        window.addEventListener("resize", resizeCanvas);

        resizeCanvas();
        drawFrame();
    </script>

    <script src="/static/landing.js"></script>
</body>
</html>
